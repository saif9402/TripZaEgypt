<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Create Account | Tour Guide</title>
    <link href="../output.css" rel="stylesheet" />
    <link rel="stylesheet" href="../css/styles.css" />
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="relative min-h-screen bg-black overflow-hidden">
    <!-- âœ… Toast Container -->
    <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

    <!-- ðŸ”¸ Blurred Placeholder -->
    <div class="absolute inset-0">
      <img
        src="../img/sign in background.png"
        class="w-full h-full object-cover blur-xl scale-105"
        alt="blurred beach placeholder"
      />
    </div>

    <!-- ðŸ”¸ Full Image -->
    <img
      src="../img/sign in background.png"
      class="absolute inset-0 w-full h-full bg-img transition-opacity duration-700 opacity-0"
      loading="lazy"
      onload="this.style.opacity=1"
      alt="background beach"
    />

    <!-- ðŸ”¸ Content Container -->
    <div
      class="relative z-10 flex items-center justify-center min-h-screen px-4 bg-black bg-opacity-40"
    >
      <div class="bg-white rounded-2xl shadow-xl p-8 max-w-md w-full">
        <div class="p-6 flex items-center justify-center">
          <img src="../img/Vector.png" alt="main logo" />
        </div>

        <!-- âœ… Registration Form -->
        <form id="registerForm" class="space-y-4">
          <div>
            <label class="block text-sm text-gray-600 mb-1" for="name"
              >Full Name</label
            >
            <input
              id="name"
              name="FullName"
              type="text"
              placeholder="Jane Doe"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:outline-none"
              required
            />
          </div>
          <div>
            <label class="block text-sm text-gray-600 mb-1" for="email"
              >Email</label
            >
            <input
              id="email"
              name="Email"
              type="email"
              placeholder="you@example.com"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:outline-none"
              required
            />
          </div>
          <div>
            <label class="block text-sm text-gray-600 mb-1" for="country"
              >Country</label
            >
            <select
              id="country"
              name="Country"
              required
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:outline-none bg-white"
            >
              <option value="">Select Country</option>
            </select>
          </div>
          <div>
            <label class="block text-sm text-gray-600 mb-1" for="phone"
              >Phone Number</label
            >
            <input
              id="phone"
              name="PhoneNumber"
              type="text"
              placeholder="+1234567890"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:outline-none"
              required
            />
          </div>
          <div>
            <label class="block text-sm text-gray-600 mb-1" for="password"
              >Password</label
            >
            <input
              id="password"
              name="Password"
              type="password"
              placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:outline-none"
              required
            />
          </div>
          <div>
            <label
              class="block text-sm text-gray-600 mb-1"
              for="confirm-password"
              >Confirm Password</label
            >
            <input
              id="confirm-password"
              type="password"
              placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:outline-none"
              required
            />
          </div>
          <button
            type="submit"
            class="w-full bg-yellow-400 text-white font-semibold py-2 rounded-lg shadow-md hover:bg-yellow-500 transition"
          >
            Create Account
          </button>
        </form>

        <!-- Divider -->
        <div class="relative my-6">
          <div class="absolute inset-0 flex items-center">
            <div class="w-full border-t border-gray-300"></div>
          </div>
          <div class="relative flex justify-center text-sm">
            <span class="px-2 bg-white text-gray-500">Or continue with</span>
          </div>
        </div>

        <!-- Google Sign-up -->
        <a
          href="https://localhost:7134/api/ExternalAuth/google-redirect-login"
          class="w-full flex items-center justify-center gap-2 bg-white border border-gray-300 rounded-lg py-2 px-4 shadow-sm hover:bg-gray-50 transition no-underline"
        >
          <img
            src="https://www.google.com/favicon.ico"
            alt="Google logo"
            class="w-5 h-5"
          />
          <span class="text-black">Sign up with Google</span>
        </a>

        <p class="text-center text-xs text-gray-400 mt-6">
          Already have an account?
          <a href="sign-in.html" class="text-yellow-500 hover:underline"
            >Sign in</a
          >
        </p>
      </div>
    </div>

    <!-- âœ… JS to Submit FormData and Show Toasts Based on Status -->
    <script>
      const countrySelect = document.getElementById("country");
      const countries = [
        "Afghanistan",
        "Albania",
        "Algeria",
        "Argentina",
        "Australia",
        "Austria",
        "Bahrain",
        "Bangladesh",
        "Belgium",
        "Brazil",
        "Canada",
        "Chile",
        "China",
        "Colombia",
        "Denmark",
        "Egypt",
        "Finland",
        "France",
        "Germany",
        "Greece",
        "India",
        "Indonesia",
        "Iran",
        "Iraq",
        "Ireland",
        "Israel",
        "Italy",
        "Japan",
        "Jordan",
        "Kenya",
        "Kuwait",
        "Lebanon",
        "Libya",
        "Malaysia",
        "Mexico",
        "Morocco",
        "Netherlands",
        "New Zealand",
        "Nigeria",
        "Norway",
        "Oman",
        "Pakistan",
        "Peru",
        "Philippines",
        "Poland",
        "Portugal",
        "Qatar",
        "Romania",
        "Russia",
        "Saudi Arabia",
        "Singapore",
        "South Africa",
        "South Korea",
        "Spain",
        "Sri Lanka",
        "Sudan",
        "Sweden",
        "Switzerland",
        "Syria",
        "Thailand",
        "Tunisia",
        "Turkey",
        "UAE",
        "UK",
        "USA",
        "Ukraine",
        "Uzbekistan",
        "Venezuela",
        "Vietnam",
        "Yemen",
        "Zimbabwe",
      ];

      countries.forEach((country) => {
        const option = document.createElement("option");
        option.value = country;
        option.textContent = country;
        countrySelect.appendChild(option);
      });

      function showToast(message, type = "success") {
        const toastContainer = document.getElementById("toast-container");
        const toast = document.createElement("div");
        toast.className = `
          max-w-sm w-full px-4 py-3 rounded-lg shadow-lg text-white animate-fade-in-up transition
          ${type === "success" ? "bg-green-600" : "bg-red-600"}
        `;
        toast.textContent = message;
        toastContainer.appendChild(toast);
        setTimeout(() => {
          toast.classList.add("opacity-0", "translate-y-2");
          toast.addEventListener("transitionend", () => toast.remove());
        }, 5000);
      }

      document
        .getElementById("registerForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();

          const form = e.target;
          const password = form.Password.value;
          const confirmPassword =
            document.getElementById("confirm-password").value;

          if (password !== confirmPassword) {
            showToast("Passwords do not match!", "error");
            return;
          }

          const formData = new FormData();
          formData.append("Email", form.Email.value);
          formData.append("FullName", form.FullName.value);
          formData.append("Country", form.Country.value);
          formData.append("Password", form.Password.value);
          formData.append("PhoneNumber", form.PhoneNumber.value);

          try {
            const response = await fetch("/api/Auth/Register", {
              method: "POST",
              body: formData,
            });

            const result = await response.json();
            const toastType = result.succeeded ? "success" : "error";
            console.log(result);

            const message =
              result.errors?.join(", ") ||
              result.message ||
              (toastType === "success"
                ? "Registration successful!"
                : "Registration failed.");

            showToast(message, toastType);

            if (result.succeeded) {
              form.reset();
            }
          } catch (err) {
            console.error(err);
            showToast("Network error. Please try again.", "error");
          }
        });
    </script>

    <!-- Optional Scripts -->
    <script src="../JS/translation.js"></script>
    <script src="../JS/transition.js"></script>
  </body>
</html>
